<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Line Plot with Plotly</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 20px;
    }
    #controls {
      margin-bottom: 20px;
    }
    .control {
      display: inline-block;
      margin: 0 15px;
    }
    .control label {
      margin-right: 5px;
    }
    #equation {
      font-size: 1.5em;
      margin-bottom: 20px;
    }
    #plot {
      width: 600px;
      height: 600px;
      margin: 0 auto;
    }
  </style>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <h1>Interactive Line Plot</h1>
  <div id="controls">
    <div class="control">
      <label for="mRange">Slope (m):</label>
      <input type="range" id="mRange" min="-10" max="10" step="0.1" value="2">
      <input type="number" id="mInput" min="-10" max="10" step="0.1" value="2">
    </div>
    <div class="control">
      <label for="cRange">Intercept (c):</label>
      <input type="range" id="cRange" min="-10" max="10" step="0.1" value="3">
      <input type="number" id="cInput" min="-10" max="10" step="0.1" value="3">
    </div>
    <div class="control">
      <label for="xMinRange">x‑Min:</label>
      <input type="range" id="xMinRange" min="-50" max="0" step="0.1" value="-10">
      <input type="number" id="xMinInput" min="-50" max="0" step="0.1" value="-10">
    </div>
    <div class="control">
      <label for="xMaxRange">x‑Max:</label>
      <input type="range" id="xMaxRange" min="0" max="50" step="0.1" value="10">
      <input type="number" id="xMaxInput" min="0" max="50" step="0.1" value="10">
    </div>
    <div class="control">
      <button id="resetBtn">Reset</button>
    </div>
  </div>
  <div id="equation">\(y = 2.00x + 3.00\)</div>
  <div id="plot"></div>

  <script>
    // References to controls
    const mRange = document.getElementById('mRange');
    const mInput = document.getElementById('mInput');
    const cRange = document.getElementById('cRange');
    const cInput = document.getElementById('cInput');
    const xMinRange = document.getElementById('xMinRange');
    const xMinInput = document.getElementById('xMinInput');
    const xMaxRange = document.getElementById('xMaxRange');
    const xMaxInput = document.getElementById('xMaxInput');
    const resetBtn = document.getElementById('resetBtn');

    // Utility to sync a slider and number input
    function sync(rangeEl, inputEl) {
      rangeEl.addEventListener('input', updatePlot);
      inputEl.addEventListener('input', e => {
        const val = parseFloat(e.target.value);
        if (!isNaN(val)) {
          rangeEl.value = val;
          updatePlot();
        }
      });
    }
    sync(mRange, mInput);
    sync(cRange, cInput);
    sync(xMinRange, xMinInput);
    sync(xMaxRange, xMaxInput);

    // Reset button handler
    resetBtn.addEventListener('click', () => {
      mRange.value = 2; mInput.value = 2;
      cRange.value = 3; cInput.value = 3;
      xMinRange.value = -10; xMinInput.value = -10;
      xMaxRange.value = 10; xMaxInput.value = 10;
      updatePlot();
    });

    // Initial trace
    const trace = {
      x: [],
      y: [],
      mode: 'lines',
      line: { color: 'red' },
      hovertemplate: '(%{x:.2f}, %{y:.2f})<extra></extra>'
    };

    const layout = {
      xaxis: { range: [-10, 10], zeroline: true, showgrid: true, dtick: 1 },
      yaxis: { range: [-10, 10], zeroline: true, showgrid: true, dtick: 1 },
      margin: { l: 40, r: 20, b: 40, t: 40 },
      hovermode: 'closest'
    };

    // Render initial plot
    Plotly.newPlot('plot', [trace], layout, { responsive: true });

    // Update function
    function updatePlot() {
      const m = parseFloat(mRange.value);
      const c = parseFloat(cRange.value);
      const xMin = parseFloat(xMinRange.value);
      const xMax = parseFloat(xMaxRange.value);

      // Sync numeric inputs
      mInput.value = m;
      cInput.value = c;
      xMinInput.value = xMin;
      xMaxInput.value = xMax;

      // Update equation with parentheses for negative c
      const cStr = c < 0 ? `(${c.toFixed(2)})` : c.toFixed(2);
      document.getElementById('equation').innerHTML = `\\(y = ${m.toFixed(2)}x + ${cStr}\\)`;
      MathJax.typesetPromise();

      // Generate x values based on domain
      const x = [];
      const step = (xMax - xMin) / 200;
      for (let xi = xMin; xi <= xMax; xi += step) {
        x.push(parseFloat(xi.toFixed(2)));
      }

      // Compute y values
      const y = x.map(xi => m * xi + c);

      // Update trace and layout
      trace.x = x;
      trace.y = y;
      layout.xaxis.range = [xMin, xMax];

      Plotly.react('plot', [trace], layout, { responsive: true });
    }

    // Initial draw
    updatePlot();
  </script>
</body>
</html>
